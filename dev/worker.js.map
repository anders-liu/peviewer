{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/worker/index.ts","webpack:///./src/worker/message.ts","webpack:///./src/worker/page-data/formatter.ts","webpack:///./src/worker/page-data/generator.ts","webpack:///./src/worker/page-data/headers.ts","webpack:///./src/worker/pe/error.ts","webpack:///./src/worker/pe/image-flags.ts","webpack:///./src/worker/pe/image.ts","webpack:///./src/worker/pe/loader.ts"],"names":[],"mappings":"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","file":"worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/worker/index.ts\");\n","import * as M from \"./message\";\r\nimport { PEImage } from \"./pe/image\";\r\nimport { generatePageData } from \"./page-data/generator\";\r\n\r\nlet pe: PEImage | null = null;\r\n\r\nonmessage = (ev) => {\r\n    const msg = ev.data as W.WorkerMessage;\r\n    switch (msg.type) {\r\n        case W.WorkerMessageType.REQ_OPEN_FILE:\r\n            handleReqOpenFile(msg as W.ReqOpenFileMessage);\r\n            break;\r\n    }\r\n};\r\n\r\nfunction handleReqOpenFile(msg: W.ReqOpenFileMessage): void {\r\n    let reader = new FileReader();\r\n\r\n    reader.onload = ev => {\r\n        try {\r\n            const buf = <ArrayBuffer>(<FileReader>ev.target).result;\r\n            pe = PEImage.load(buf);\r\n            const pageData = generatePageData(pe, W.PageID.HEADERS);\r\n            const msg = M.createResPageDataMessage(pageData);\r\n            postMessage(msg);\r\n        } catch (ex) {\r\n            const msg = M.createResPEErrorMessage(ex.message\r\n                || `Unknown error: ${JSON.stringify(ex)}`);\r\n            postMessage(msg);\r\n        }\r\n    };\r\n\r\n    reader.onerror = ev => {\r\n        pe = null;\r\n        const msg = M.createResPEErrorMessage(\"Can't open file.\");\r\n        postMessage(msg);\r\n    };\r\n\r\n    reader.readAsArrayBuffer(msg.file);\r\n}\r\n","export function createResNavDataMessage(navList: W.NavData[]): W.ResNavDataMessage {\r\n    return {\r\n        type: W.WorkerMessageType.RES_NAV_DATA,\r\n        navList\r\n    };\r\n}\r\n\r\nexport function createResPageDataMessage(pageData: W.PageData): W.ResPageDataMessage {\r\n    return {\r\n        type: W.WorkerMessageType.RES_PAGE_DATA,\r\n        pageData\r\n    };\r\n}\r\n\r\nexport function createResPEErrorMessage(error: string): W.ResPEErrorMessage {\r\n    return {\r\n        type: W.WorkerMessageType.RES_PE_ERROR,\r\n        error\r\n    };\r\n}\r\n","import * as S from \"../pe/structures\";\r\nimport { format } from \"url\";\r\n\r\nexport function formatU1RawHex(d: number): string {\r\n    return padZeroLeft(d.toString(16).toUpperCase(), 2);\r\n}\r\n\r\nexport function formatU2RawHex(d: number): string {\r\n    return padZeroLeft(d.toString(16).toUpperCase(), 4);\r\n}\r\n\r\nexport function formatU4RawHex(d: number): string {\r\n    return padZeroLeft(d.toString(16).toUpperCase(), 8);\r\n}\r\n\r\nexport function formatU1Hex(d: number): string {\r\n    return `${formatU1RawHex(d)}h`;\r\n}\r\n\r\nexport function formatU2Hex(d: number): string {\r\n    return `${formatU2RawHex(d)}h`;\r\n}\r\n\r\nexport function formatU4Hex(d: number): string {\r\n    return `${formatU4RawHex(d)}h`;\r\n}\r\n\r\nexport function formatHexDec(d: number): string {\r\n    return `${d.toString(16).toUpperCase()}h (${d})`;\r\n}\r\n\r\nexport function formatBytes(bytes: Uint8Array, lineWidth: number = 16): string[] {\r\n    let lines: string[] = [];\r\n    for (let start = 0; start < bytes.length; start += lineWidth) {\r\n        const line = Array.from(bytes.subarray(start, start + lineWidth))\r\n            .map(b => formatU1RawHex(b)).join(\"-\");\r\n        lines.push(line);\r\n    }\r\n    return lines;\r\n}\r\n\r\nexport function formatStructTitle(s: S.FileData, title: string): string {\r\n    return `${title} [${formatU4Hex(s._offset)} - ${formatU4Hex(s._offset + s._size)} : ${formatHexDec(s._size)}]`;\r\n}\r\n\r\nexport function formatU1Field(name: string, f: S.U1Field, showDec?: boolean): W.StructItem {\r\n    return formatUIntField(name, f, 1, showDec);\r\n}\r\n\r\nexport function formatU2Field(name: string, f: S.U2Field, showDec?: boolean): W.StructItem {\r\n    return formatUIntField(name, f, 2, showDec);\r\n}\r\n\r\nexport function formatU4Field(name: string, f: S.U4Field, showDec?: boolean): W.StructItem {\r\n    return formatUIntField(name, f, 4, showDec);\r\n}\r\n\r\nexport function formatU8Field(name: string, f: S.U8Field): W.StructItem {\r\n    return {\r\n        offset: formatU4Hex(f._offset),\r\n        size: formatHexDec(f._size),\r\n        rawData: formatBytes(f.data),\r\n        name,\r\n        value: `${formatU4RawHex(f.high)} ${formatU4Hex(f.low)}`,\r\n    }\r\n}\r\n\r\nexport function formatBytesField(name: string, f: S.Field): W.StructItem {\r\n    return {\r\n        offset: formatU4Hex(f._offset),\r\n        size: formatHexDec(f._size),\r\n        rawData: formatBytes(f.data),\r\n        name,\r\n        value: \"\",\r\n    }\r\n}\r\n\r\nfunction padZeroLeft(str: string, len: number): string {\r\n    if (str.length < len) {\r\n        return \"0\".repeat(len - str.length) + str;\r\n    } else {\r\n        return str;\r\n    }\r\n}\r\n\r\nfunction formatUIntField(name: string, f: S.UIntField, sz: number, showDec?: boolean): W.StructItem {\r\n    let hex: string;\r\n    switch (sz) {\r\n        case 1: hex = formatU1Hex(f.value); break;\r\n        case 2: hex = formatU2Hex(f.value); break;\r\n        case 4: hex = formatU4Hex(f.value); break;\r\n        default: hex = f.value.toString(16).toUpperCase(); break;\r\n    }\r\n\r\n    return {\r\n        offset: formatU4Hex(f._offset),\r\n        size: formatHexDec(f._size),\r\n        rawData: formatBytes(f.data),\r\n        name,\r\n        value: showDec ? `${hex} (${f.value})` : hex,\r\n    }\r\n}\r\n","import { PEImage } from \"../pe/image\";\r\nimport { generateHeadersPageData } from \"./headers\";\r\n\r\nexport function generatePageData(pe: PEImage, pageID: W.PageID): W.PageData {\r\n    switch (pageID) {\r\n        case W.PageID.HEADERS: return generateHeadersPageData(pe);\r\n        default: return { id: W.PageID.NOTFOUND, title: \"Page Not Found\" };\r\n    }\r\n}","import { PEImage } from \"../pe/image\";\r\nimport * as FM from \"./formatter\";\r\nimport { Z_UNKNOWN } from \"zlib\";\r\n\r\nexport function generateHeadersPageData(pe: PEImage): W.HeadersPageData {\r\n    return {\r\n        id: W.PageID.HEADERS,\r\n        title: \"Headers\",\r\n        dosHeader: generateDosHeader(pe),\r\n        peSignature: generatePESignature(pe),\r\n        fileHeader: generateFileHeader(pe),\r\n        optionalHeader: generateOptionalHeader(pe),\r\n        sectionHeaders: generateSectionHeaders(pe),\r\n    };\r\n}\r\n\r\nfunction generateDosHeader(pe: PEImage): W.SimpleStruct {\r\n    let s: W.SimpleStruct = {\r\n        title: \"DOS Header\",\r\n        elemID: W.KnownElemID.DOS_HEADER,\r\n    };\r\n\r\n    const h = pe.getDosHeader();\r\n    if (!h) return s;\r\n\r\n    s.items = [\r\n        FM.formatU2Field(\"e_magic\", h.e_magic),\r\n        FM.formatU2Field(\"e_cblp\", h.e_cblp),\r\n        FM.formatU2Field(\"e_cp\", h.e_cp),\r\n        FM.formatU2Field(\"e_crlc\", h.e_crlc),\r\n        FM.formatU2Field(\"e_cparhdr\", h.e_cparhdr),\r\n        FM.formatU2Field(\"e_minalloc\", h.e_minalloc),\r\n        FM.formatU2Field(\"e_maxalloc\", h.e_maxalloc),\r\n        FM.formatU2Field(\"e_ss\", h.e_ss),\r\n        FM.formatU2Field(\"e_sp\", h.e_sp),\r\n        FM.formatU2Field(\"e_csum\", h.e_csum),\r\n        FM.formatU2Field(\"e_ip\", h.e_ip),\r\n        FM.formatU2Field(\"e_cs\", h.e_cs),\r\n        FM.formatU2Field(\"e_lfarlc\", h.e_lfarlc),\r\n        FM.formatU2Field(\"e_ovno\", h.e_ovno),\r\n        FM.formatBytesField(\"e_res\", h.e_res),\r\n        FM.formatU2Field(\"e_oemid\", h.e_oemid),\r\n        FM.formatU2Field(\"e_oeminfo\", h.e_oeminfo),\r\n        FM.formatBytesField(\"e_res2\", h.e_res2),\r\n        FM.formatU4Field(\"e_lfanew\", h.e_lfanew),\r\n    ];\r\n\r\n    return s;\r\n}\r\n\r\nfunction generatePESignature(pe: PEImage): W.SimpleStruct {\r\n    let s: W.SimpleStruct = {\r\n        title: \"PE Signature\",\r\n        elemID: W.KnownElemID.PE_SIGNATURE,\r\n    };\r\n\r\n    const h = pe.getPESignature();\r\n    if (!h) return s;\r\n\r\n    s.items = [\r\n        FM.formatU4Field(\"PE Signature\", h),\r\n    ];\r\n\r\n    return s;\r\n}\r\n\r\nfunction generateFileHeader(pe: PEImage): W.SimpleStruct {\r\n    let s: W.SimpleStruct = {\r\n        title: \"File Header\",\r\n        elemID: W.KnownElemID.FILE_HEADER,\r\n    };\r\n\r\n    // TODO\r\n    return s;\r\n}\r\n\r\nfunction generateOptionalHeader(pe: PEImage): W.GroupedStruct {\r\n    let s: W.SimpleStruct = {\r\n        title: \"Optional Header\",\r\n        elemID: W.KnownElemID.OPTIONAL_HEADER,\r\n    };\r\n\r\n    // TODO\r\n    return s;\r\n}\r\n\r\nfunction generateSectionHeaders(pe: PEImage): W.GroupedStruct {\r\n    let s: W.SimpleStruct = {\r\n        title: \"Section headers\",\r\n        elemID: W.KnownElemID.SECTION_HEADERS,\r\n    };\r\n\r\n    // TODO\r\n    return s;\r\n}\r\n","export const enum PEErrorType {\r\n    INVALID_DATA_POSITION = \"INVALID_DATA_POSITION\",\r\n    INVALID_DOS_SIGNATURE = \"INVALID_DOS_SIGNATURE\",\r\n    INVALID_PE_SIGNATURE = \"INVALID_PE_SIGNATURE\",\r\n    INVALID_OPTIONAL_HEADER_MAGIC = \"INVALID_OPTIONAL_HEADER_MAGIC\",\r\n    INVALID_DATA_DIRECTORY_COUNT = \"INVALID_DATA_DIRECTORY_COUNT\",\r\n}\r\n\r\nexport class PEError extends Error {\r\n    constructor(\r\n        public type: PEErrorType,\r\n        public offset?: number,\r\n        public size?: number\r\n    ) {\r\n        super(type);\r\n    }\r\n}\r\n","export const IMAGE_DOS_SIGNATURE = 0x5A4D;  // MZ\r\n\r\nexport const IMAGE_NT_SIGNATURE = 0x00004550;  // PE00\r\n\r\nexport const IMAGE_NT_OPTIONAL_HDR32_MAGIC = 0x10b;\r\nexport const IMAGE_NT_OPTIONAL_HDR64_MAGIC = 0x20b;\r\n\r\nexport enum ImageFile {\r\n    IMAGE_FILE_RELOCS_STRIPPED = 0x0001,\r\n    IMAGE_FILE_EXECUTABLE_IMAGE = 0x0002,\r\n    IMAGE_FILE_LINE_NUMS_STRIPPED = 0x0004,\r\n    IMAGE_FILE_LOCAL_SYMS_STRIPPED = 0x0008,\r\n    IMAGE_FILE_AGGRESIVE_WS_TRIM = 0x0010,\r\n    IMAGE_FILE_LARGE_ADDRESS_AWARE = 0x0020,\r\n    IMAGE_FILE_BYTES_REVERSED_LO = 0x0080,\r\n    IMAGE_FILE_32BIT_MACHINE = 0x0100,\r\n    IMAGE_FILE_DEBUG_STRIPPED = 0x0200,\r\n    IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP = 0x0400,\r\n    IMAGE_FILE_NET_RUN_FROM_SWAP = 0x0800,\r\n    IMAGE_FILE_SYSTEM = 0x1000,\r\n    IMAGE_FILE_DLL = 0x2000,\r\n    IMAGE_FILE_UP_SYSTEM_ONLY = 0x4000,\r\n    IMAGE_FILE_BYTES_REVERSED_HI = 0x8000,\r\n}\r\n\r\nexport enum ImageFileMachine {\r\n    IMAGE_FILE_MACHINE_UNKNOWN = 0,\r\n    IMAGE_FILE_MACHINE_TARGET_HOST = 0x0001,\r\n    IMAGE_FILE_MACHINE_I386 = 0x014c,\r\n    IMAGE_FILE_MACHINE_R3000 = 0x0162,\r\n    IMAGE_FILE_MACHINE_R4000 = 0x0166,\r\n    IMAGE_FILE_MACHINE_R10000 = 0x0168,\r\n    IMAGE_FILE_MACHINE_WCEMIPSV2 = 0x0169,\r\n    IMAGE_FILE_MACHINE_ALPHA = 0x0184,\r\n    IMAGE_FILE_MACHINE_SH3 = 0x01a2,\r\n    IMAGE_FILE_MACHINE_SH3DSP = 0x01a3,\r\n    IMAGE_FILE_MACHINE_SH3E = 0x01a4,\r\n    IMAGE_FILE_MACHINE_SH4 = 0x01a6,\r\n    IMAGE_FILE_MACHINE_SH5 = 0x01a8,\r\n    IMAGE_FILE_MACHINE_ARM = 0x01c0,\r\n    IMAGE_FILE_MACHINE_THUMB = 0x01c2,\r\n    IMAGE_FILE_MACHINE_ARMNT = 0x01c4,\r\n    IMAGE_FILE_MACHINE_AM33 = 0x01d3,\r\n    IMAGE_FILE_MACHINE_POWERPC = 0x01F0,\r\n    IMAGE_FILE_MACHINE_POWERPCFP = 0x01f1,\r\n    IMAGE_FILE_MACHINE_IA64 = 0x0200,\r\n    IMAGE_FILE_MACHINE_MIPS16 = 0x0266,\r\n    IMAGE_FILE_MACHINE_ALPHA64 = 0x0284,\r\n    IMAGE_FILE_MACHINE_MIPSFPU = 0x0366,\r\n    IMAGE_FILE_MACHINE_MIPSFPU16 = 0x0466,\r\n    IMAGE_FILE_MACHINE_AXP64 = IMAGE_FILE_MACHINE_ALPHA64,\r\n    IMAGE_FILE_MACHINE_TRICORE = 0x0520,\r\n    IMAGE_FILE_MACHINE_CEF = 0x0CEF,\r\n    IMAGE_FILE_MACHINE_EBC = 0x0EBC,\r\n    IMAGE_FILE_MACHINE_AMD64 = 0x8664,\r\n    IMAGE_FILE_MACHINE_M32R = 0x9041,\r\n    IMAGE_FILE_MACHINE_ARM64 = 0xAA64,\r\n    IMAGE_FILE_MACHINE_CEE = 0xC0EE,\r\n}\r\n\r\nexport enum ImageSubsystem {\r\n    IMAGE_SUBSYSTEM_UNKNOWN = 0,\r\n    IMAGE_SUBSYSTEM_NATIVE = 1,\r\n    IMAGE_SUBSYSTEM_WINDOWS_GUI = 2,\r\n    IMAGE_SUBSYSTEM_WINDOWS_CUI = 3,\r\n    IMAGE_SUBSYSTEM_OS2_CUI = 5,\r\n    IMAGE_SUBSYSTEM_POSIX_CUI = 7,\r\n    IMAGE_SUBSYSTEM_NATIVE_WINDOWS = 8,\r\n    IMAGE_SUBSYSTEM_WINDOWS_CE_GUI = 9,\r\n    IMAGE_SUBSYSTEM_EFI_APPLICATION = 10,\r\n    IMAGE_SUBSYSTEM_EFI_BOOT_SERVICE_DRIVER = 11,\r\n    IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER = 12,\r\n    IMAGE_SUBSYSTEM_EFI_ROM = 13,\r\n    IMAGE_SUBSYSTEM_XBOX = 14,\r\n    IMAGE_SUBSYSTEM_WINDOWS_BOOT_APPLICATION = 16,\r\n    IMAGE_SUBSYSTEM_XBOX_CODE_CATALOG = 17,\r\n}\r\n\r\nexport enum ImageDllCharacteristics {\r\n    IMAGE_DLLCHARACTERISTICS_HIGH_ENTROPY_VA = 0x0020,\r\n    IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE = 0x0040,\r\n    IMAGE_DLLCHARACTERISTICS_FORCE_INTEGRITY = 0x0080,\r\n    IMAGE_DLLCHARACTERISTICS_NX_COMPAT = 0x0100,\r\n    IMAGE_DLLCHARACTERISTICS_NO_ISOLATION = 0x0200,\r\n    IMAGE_DLLCHARACTERISTICS_NO_SEH = 0x0400,\r\n    IMAGE_DLLCHARACTERISTICS_NO_BIND = 0x0800,\r\n    IMAGE_DLLCHARACTERISTICS_APPCONTAINER = 0x1000,\r\n    IMAGE_DLLCHARACTERISTICS_WDM_DRIVER = 0x2000,\r\n    IMAGE_DLLCHARACTERISTICS_GUARD_CF = 0x4000,\r\n    IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE = 0x8000,\r\n}\r\n\r\nexport enum ImageDirectoryEntry {\r\n    IMAGE_DIRECTORY_ENTRY_EXPORT = 0,\r\n    IMAGE_DIRECTORY_ENTRY_IMPORT = 1,\r\n    IMAGE_DIRECTORY_ENTRY_RESOURCE = 2,\r\n    IMAGE_DIRECTORY_ENTRY_EXCEPTION = 3,\r\n    IMAGE_DIRECTORY_ENTRY_SECURITY = 4,\r\n    IMAGE_DIRECTORY_ENTRY_BASERELOC = 5,\r\n    IMAGE_DIRECTORY_ENTRY_DEBUG = 6,\r\n    IMAGE_DIRECTORY_ENTRY_ARCHITECTURE = 7,\r\n    IMAGE_DIRECTORY_ENTRY_GLOBALPTR = 8,\r\n    IMAGE_DIRECTORY_ENTRY_TLS = 9,\r\n    IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG = 10,\r\n    IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT = 11,\r\n    IMAGE_DIRECTORY_ENTRY_IAT = 12,\r\n    IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT = 13,\r\n    IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR = 14,\r\n}\r\n\r\nexport const IMAGE_NUMBEROF_DIRECTORY_ENTRIES = 16;\r\n\r\nexport enum ImageSection {\r\n    IMAGE_SCN_TYPE_NO_PAD = 0x00000008,\r\n\r\n    IMAGE_SCN_CNT_CODE = 0x00000020,\r\n    IMAGE_SCN_CNT_INITIALIZED_DATA = 0x00000040,\r\n    IMAGE_SCN_CNT_UNINITIALIZED_DATA = 0x00000080,\r\n\r\n    IMAGE_SCN_LNK_OTHER = 0x00000100,\r\n    IMAGE_SCN_LNK_INFO = 0x00000200,\r\n    IMAGE_SCN_LNK_REMOVE = 0x00000800,\r\n    IMAGE_SCN_LNK_COMDAT = 0x00001000,\r\n\r\n    IMAGE_SCN_NO_DEFER_SPEC_EXC = 0x00004000,\r\n    IMAGE_SCN_GPREL = 0x00008000,\r\n\r\n    IMAGE_SCN_MEM_PURGEABLE = 0x00020000,\r\n    IMAGE_SCN_MEM_16BIT = 0x00020000,\r\n    IMAGE_SCN_MEM_LOCKED = 0x00040000,\r\n    IMAGE_SCN_MEM_PRELOAD = 0x00080000,\r\n\r\n    IMAGE_SCN_ALIGN_1BYTES = 0x00100000,\r\n    IMAGE_SCN_ALIGN_2BYTES = 0x00200000,\r\n    IMAGE_SCN_ALIGN_4BYTES = 0x00300000,\r\n    IMAGE_SCN_ALIGN_8BYTES = 0x00400000,\r\n    IMAGE_SCN_ALIGN_16BYTES = 0x00500000,\r\n    IMAGE_SCN_ALIGN_32BYTES = 0x00600000,\r\n    IMAGE_SCN_ALIGN_64BYTES = 0x00700000,\r\n    IMAGE_SCN_ALIGN_128BYTES = 0x00800000,\r\n    IMAGE_SCN_ALIGN_256BYTES = 0x00900000,\r\n    IMAGE_SCN_ALIGN_512BYTES = 0x00A00000,\r\n    IMAGE_SCN_ALIGN_1024BYTES = 0x00B00000,\r\n    IMAGE_SCN_ALIGN_2048BYTES = 0x00C00000,\r\n    IMAGE_SCN_ALIGN_4096BYTES = 0x00D00000,\r\n    IMAGE_SCN_ALIGN_8192BYTES = 0x00E00000,\r\n\r\n    IMAGE_SCN_LNK_NRELOC_OVFL = 0x01000000,\r\n    IMAGE_SCN_MEM_DISCARDABLE = 0x02000000,\r\n    IMAGE_SCN_MEM_NOT_CACHED = 0x04000000,\r\n    IMAGE_SCN_MEM_NOT_PAGED = 0x08000000,\r\n    IMAGE_SCN_MEM_SHARED = 0x10000000,\r\n    IMAGE_SCN_MEM_EXECUTE = 0x20000000,\r\n    IMAGE_SCN_MEM_READ = 0x40000000,\r\n    IMAGE_SCN_MEM_WRITE = 0x80000000,\r\n\r\n    IMAGE_SCN_SCALE_INDEX = 0x00000001,\r\n}","import * as S from \"./structures\";\r\nimport * as L from \"./loader\";\r\nimport * as F from \"./image-flags\";\r\nimport * as E from \"./error\";\r\n\r\nexport class PEImage implements L.FileDataProvider {\r\n    public static load(buf: ArrayBuffer): PEImage {\r\n        return new PEImage(buf);\r\n    }\r\n\r\n    public getU1(p: number): number {\r\n        this.check(p, 1);\r\n        return this.data.getUint8(p);\r\n    }\r\n\r\n    public getU2(p: number): number {\r\n        this.check(p, 2);\r\n        return this.data.getUint16(p, true);\r\n    }\r\n\r\n    public getU4(p: number): number {\r\n        this.check(p, 3);\r\n        return this.data.getUint32(p, true);\r\n    }\r\n\r\n    public getData(p: number, sz: number): Uint8Array {\r\n        this.check(p, sz);\r\n        return new Uint8Array(this.data.buffer.slice(p, p + sz));\r\n    }\r\n\r\n    public getDosHeader(): S.ImageDosHeader | undefined {\r\n        return this.dosHeader;\r\n    }\r\n\r\n    public getPESignature(): S.U4Field | undefined {\r\n        return this.peSignature;\r\n    }\r\n\r\n    public getFileHeader(): S.ImageFileHeader | undefined {\r\n        return this.fileHeader;\r\n    }\r\n\r\n    public getOptionalHeader(): S.ImageOptionalHeader32 | S.ImageOptionalHeader64 | undefined {\r\n        return this.optionalHeader;\r\n    }\r\n\r\n    public getDataDirectories(): S.StructArray<S.ImageDataDirectory> | undefined {\r\n        return this.dataDirectories;\r\n    }\r\n\r\n    public getSectionHeaders(): S.StructArray<S.ImageSectionHeader> | undefined {\r\n        return this.sectionHeaders;\r\n    }\r\n\r\n    private check(p: number, sz: number): void {\r\n        if (p < 0 || p >= this.data.byteLength\r\n            || sz < 0 || p + sz > this.data.byteLength) {\r\n            throw new E.PEError(E.PEErrorType.INVALID_DATA_POSITION, p, sz);\r\n        }\r\n    }\r\n\r\n    private constructor(buf: ArrayBuffer) {\r\n        this.data = new DataView(buf);\r\n        this.loadHeaders();\r\n    }\r\n\r\n    private loadHeaders(): void {\r\n        let ptr = 0;\r\n        this.dosHeader = L.loadImageDosHeader(this, ptr);\r\n\r\n        if (this.dosHeader.e_magic.value != F.IMAGE_DOS_SIGNATURE) {\r\n            throw new E.PEError(E.PEErrorType.INVALID_DOS_SIGNATURE, ptr, 2);\r\n        }\r\n\r\n        ptr = this.dosHeader.e_lfanew.value;\r\n        this.peSignature = L.loadU4Field(this, ptr);\r\n\r\n        if (this.peSignature.value != F.IMAGE_NT_SIGNATURE) {\r\n            throw new E.PEError(E.PEErrorType.INVALID_PE_SIGNATURE, ptr, 4);\r\n        }\r\n\r\n        ptr += this.peSignature._size;\r\n        this.fileHeader = L.loadImageFileHeader(this, ptr);\r\n\r\n        ptr += this.fileHeader._size;\r\n        const magic = L.loadU2Field(this, ptr);\r\n        switch (magic.value) {\r\n            case F.IMAGE_NT_OPTIONAL_HDR32_MAGIC:\r\n                this.optionalHeader = L.loadImageOptionalHeader32(this, ptr);\r\n                break;\r\n            case F.IMAGE_NT_OPTIONAL_HDR64_MAGIC:\r\n                this.optionalHeader = L.loadImageOptionalHeader64(this, ptr);\r\n                break;\r\n            default:\r\n                throw new E.PEError(E.PEErrorType.INVALID_OPTIONAL_HEADER_MAGIC, ptr, 2);\r\n        }\r\n\r\n        if (this.optionalHeader.NumberOfRvaAndSizes.value != F.IMAGE_NUMBEROF_DIRECTORY_ENTRIES) {\r\n            throw new E.PEError(E.PEErrorType.INVALID_DATA_DIRECTORY_COUNT,\r\n                this.optionalHeader.NumberOfRvaAndSizes._offset,\r\n                this.optionalHeader.NumberOfRvaAndSizes._size);\r\n        }\r\n\r\n        ptr += this.optionalHeader._size;\r\n        this.dataDirectories = L.loadStructArrayByCount(this, ptr,\r\n            L.loadImageDataDirectory,\r\n            this.optionalHeader.NumberOfRvaAndSizes.value);\r\n\r\n        ptr += this.dataDirectories._size;\r\n        this.sectionHeaders = L.loadStructArrayByCount(this, ptr,\r\n            L.loadImageSectionHeader,\r\n            this.fileHeader.NumberOfSections.value);\r\n    }\r\n\r\n    private readonly data: DataView;\r\n\r\n    private dosHeader?: S.ImageDosHeader;\r\n    private peSignature?: S.U4Field;\r\n    private fileHeader?: S.ImageFileHeader;\r\n    private optionalHeader?: S.ImageOptionalHeader32 | S.ImageOptionalHeader64;\r\n    private dataDirectories?: S.StructArray<S.ImageDataDirectory>;\r\n    private sectionHeaders?: S.StructArray<S.ImageSectionHeader>;\r\n}\r\n","import * as S from \"./structures\";\r\nimport * as F from \"./image-flags\";\r\n\r\nexport interface FileDataProvider {\r\n    getU1(p: number): number;\r\n    getU2(p: number): number;\r\n    getU4(p: number): number;\r\n    getData(p: number, sz: number): Uint8Array;\r\n}\r\n\r\n//\r\n// Basic structures.\r\n//\r\n\r\nexport function loadU1Field(d: FileDataProvider, p: number): S.U1Field {\r\n    return {\r\n        _offset: p, _size: 1, data: d.getData(p, 1), value: d.getU1(p)\r\n    };\r\n}\r\n\r\nexport function loadU2Field(d: FileDataProvider, p: number): S.U2Field {\r\n    return {\r\n        _offset: p, _size: 2, data: d.getData(p, 2), value: d.getU2(p)\r\n    };\r\n}\r\n\r\nexport function loadU4Field(d: FileDataProvider, p: number): S.U4Field {\r\n    return {\r\n        _offset: p, _size: 4, data: d.getData(p, 4), value: d.getU4(p)\r\n    };\r\n}\r\n\r\nexport function loadU8Field(d: FileDataProvider, p: number): S.U8Field {\r\n    const low = d.getU4(p);\r\n    const high = d.getU4(p + 4);\r\n\r\n    return {\r\n        _offset: p, _size: 8, data: d.getData(p, 8), low, high\r\n    };\r\n}\r\n\r\nexport function loadU1EnumField<T>(d: FileDataProvider, p: number): S.U1EnumField<T> {\r\n    return {\r\n        _offset: p, _size: 1, data: d.getData(p, 1), value: d.getU1(p) as any as T\r\n    };\r\n}\r\n\r\nexport function loadU2EnumField<T>(d: FileDataProvider, p: number): S.U2EnumField<T> {\r\n    return {\r\n        _offset: p, _size: 2, data: d.getData(p, 2), value: d.getU2(p) as any as T\r\n    };\r\n}\r\n\r\nexport function loadU4EnumField<T>(d: FileDataProvider, p: number): S.U4EnumField<T> {\r\n    return {\r\n        _offset: p, _size: 4, data: d.getData(p, 4), value: d.getU4(p) as any as T\r\n    };\r\n}\r\n\r\nexport function loadFixedSizeByteArray(d: FileDataProvider, p: number, sz: number): S.Field {\r\n    return {\r\n        _offset: p, _size: sz, data: d.getData(p, sz)\r\n    };\r\n}\r\n\r\nexport function loadFixedSizeAsciiStringField(d: FileDataProvider, p: number, sz: number): S.StringField {\r\n    const data = d.getData(p, sz);\r\n    const value = String.fromCharCode.apply(null, Array.from(data));\r\n\r\n    return {\r\n        _offset: p, _size: sz, data, value\r\n    };\r\n}\r\n\r\nexport function loadStructArrayByCount<T extends S.FileData>(\r\n    d: FileDataProvider,\r\n    p: number,\r\n    loader: (d: FileDataProvider, p: number) => T,\r\n    count: number): S.StructArray<T> {\r\n\r\n    let items: T[] = [];\r\n    let ptr = p;\r\n    for (let i = 0; i < count; i++) {\r\n        const s = loader(d, ptr);\r\n        items.push(s);\r\n        ptr += s._size;\r\n    }\r\n\r\n    return { _offset: p, _size: ptr - p, items };\r\n}\r\n\r\n//\r\n// Image headers.\r\n//\r\n\r\nexport function loadImageDosHeader(d: FileDataProvider, p: number): S.ImageDosHeader {\r\n    let ptr = p;\r\n\r\n    const e_magic = loadU2Field(d, ptr);\r\n    ptr += e_magic._size;\r\n\r\n    const e_cblp = loadU2Field(d, ptr);\r\n    ptr += e_cblp._size;\r\n\r\n    const e_cp = loadU2Field(d, ptr);\r\n    ptr += e_cp._size;\r\n\r\n    const e_crlc = loadU2Field(d, ptr);\r\n    ptr += e_crlc._size;\r\n\r\n    const e_cparhdr = loadU2Field(d, ptr);\r\n    ptr += e_cparhdr._size;\r\n\r\n    const e_minalloc = loadU2Field(d, ptr);\r\n    ptr += e_minalloc._size;\r\n\r\n    const e_maxalloc = loadU2Field(d, ptr);\r\n    ptr += e_maxalloc._size;\r\n\r\n    const e_ss = loadU2Field(d, ptr);\r\n    ptr += e_ss._size;\r\n\r\n    const e_sp = loadU2Field(d, ptr);\r\n    ptr += e_sp._size;\r\n\r\n    const e_csum = loadU2Field(d, ptr);\r\n    ptr += e_csum._size;\r\n\r\n    const e_ip = loadU2Field(d, ptr);\r\n    ptr += e_ip._size;\r\n\r\n    const e_cs = loadU2Field(d, ptr);\r\n    ptr += e_cs._size;\r\n\r\n    const e_lfarlc = loadU2Field(d, ptr);\r\n    ptr += e_lfarlc._size;\r\n\r\n    const e_ovno = loadU2Field(d, ptr);\r\n    ptr += e_ovno._size;\r\n\r\n    const e_res = loadFixedSizeByteArray(d, ptr, 4 * 2);\r\n    ptr += e_res._size;\r\n\r\n    const e_oemid = loadU2Field(d, ptr);\r\n    ptr += e_oemid._size;\r\n\r\n    const e_oeminfo = loadU2Field(d, ptr);\r\n    ptr += e_oeminfo._size;\r\n\r\n    const e_res2 = loadFixedSizeByteArray(d, ptr, 10 * 2);\r\n    ptr += e_res2._size;\r\n\r\n    const e_lfanew = loadU4Field(d, ptr);\r\n    ptr += e_lfanew._size;\r\n\r\n    return {\r\n        _offset: p, _size: ptr - p,\r\n        e_magic,\r\n        e_cblp,\r\n        e_cp,\r\n        e_crlc,\r\n        e_cparhdr,\r\n        e_minalloc,\r\n        e_maxalloc,\r\n        e_ss,\r\n        e_sp,\r\n        e_csum,\r\n        e_ip,\r\n        e_cs,\r\n        e_lfarlc,\r\n        e_ovno,\r\n        e_res,\r\n        e_oemid,\r\n        e_oeminfo,\r\n        e_res2,\r\n        e_lfanew,\r\n    };\r\n}\r\n\r\nexport function loadImageFileHeader(d: FileDataProvider, p: number): S.ImageFileHeader {\r\n    let ptr = p;\r\n\r\n    const Machine = loadU2Field(d, ptr);\r\n    ptr += Machine._size;\r\n\r\n    const NumberOfSections = loadU2Field(d, ptr);\r\n    ptr += NumberOfSections._size;\r\n\r\n    const TimeDateStamp = loadU4Field(d, ptr);\r\n    ptr += TimeDateStamp._size;\r\n\r\n    const PointerToSymbolTable = loadU4Field(d, ptr);\r\n    ptr += PointerToSymbolTable._size;\r\n\r\n    const NumberOfSymbols = loadU4Field(d, ptr);\r\n    ptr += NumberOfSymbols._size;\r\n\r\n    const SizeOfOptionalHeader = loadU2Field(d, ptr);\r\n    ptr += SizeOfOptionalHeader._size;\r\n\r\n    const Characteristics = loadU2EnumField<F.ImageFile>(d, ptr);\r\n    ptr += Characteristics._size;\r\n\r\n    return {\r\n        _offset: p, _size: ptr - p,\r\n        Machine,\r\n        NumberOfSections,\r\n        TimeDateStamp,\r\n        PointerToSymbolTable,\r\n        NumberOfSymbols,\r\n        SizeOfOptionalHeader,\r\n        Characteristics,\r\n    };\r\n}\r\n\r\nexport function loadImageOptionalHeader32(d: FileDataProvider, p: number): S.ImageOptionalHeader32 {\r\n    let ptr = p;\r\n\r\n    const Magic = loadU2Field(d, ptr);\r\n    ptr += Magic._size;\r\n\r\n    const MajorLinkerVersion = loadU1Field(d, ptr);\r\n    ptr += MajorLinkerVersion._size;\r\n\r\n    const MinorLinkerVersion = loadU1Field(d, ptr);\r\n    ptr += MinorLinkerVersion._size;\r\n\r\n    const SizeOfCode = loadU4Field(d, ptr);\r\n    ptr += SizeOfCode._size;\r\n\r\n    const SizeOfInitializedData = loadU4Field(d, ptr);\r\n    ptr += SizeOfInitializedData._size;\r\n\r\n    const SizeOfUninitializedData = loadU4Field(d, ptr);\r\n    ptr += SizeOfUninitializedData._size;\r\n\r\n    const AddressOfEntryPoint = loadU4Field(d, ptr);\r\n    ptr += AddressOfEntryPoint._size;\r\n\r\n    const BaseOfCode = loadU4Field(d, ptr);\r\n    ptr += BaseOfCode._size;\r\n\r\n    const BaseOfData = loadU4Field(d, ptr);\r\n    ptr += BaseOfData._size;\r\n\r\n    const ImageBase = loadU4Field(d, ptr);\r\n    ptr += ImageBase._size;\r\n\r\n    const SectionAlignment = loadU4Field(d, ptr);\r\n    ptr += SectionAlignment._size;\r\n\r\n    const FileAlignment = loadU4Field(d, ptr);\r\n    ptr += FileAlignment._size;\r\n\r\n    const MajorOperatingSystemVersion = loadU2Field(d, ptr);\r\n    ptr += MajorOperatingSystemVersion._size;\r\n\r\n    const MinorOperatingSystemVersion = loadU2Field(d, ptr);\r\n    ptr += MinorOperatingSystemVersion._size;\r\n\r\n    const MajorImageVersion = loadU2Field(d, ptr);\r\n    ptr += MajorImageVersion._size;\r\n\r\n    const MinorImageVersion = loadU2Field(d, ptr);\r\n    ptr += MinorImageVersion._size;\r\n\r\n    const MajorSubsystemVersion = loadU2Field(d, ptr);\r\n    ptr += MajorSubsystemVersion._size;\r\n\r\n    const MinorSubsystemVersion = loadU2Field(d, ptr);\r\n    ptr += MinorSubsystemVersion._size;\r\n\r\n    const Win32VersionValue = loadU4Field(d, ptr);\r\n    ptr += Win32VersionValue._size;\r\n\r\n    const SizeOfImage = loadU4Field(d, ptr);\r\n    ptr += SizeOfImage._size;\r\n\r\n    const SizeOfHeaders = loadU4Field(d, ptr);\r\n    ptr += SizeOfHeaders._size;\r\n\r\n    const CheckSum = loadU4Field(d, ptr);\r\n    ptr += CheckSum._size;\r\n\r\n    const Subsystem = loadU2EnumField<F.ImageSubsystem>(d, ptr);\r\n    ptr += Subsystem._size;\r\n\r\n    const DllCharacteristics = loadU2EnumField<F.ImageDllCharacteristics>(d, ptr);\r\n    ptr += DllCharacteristics._size;\r\n\r\n    const SizeOfStackReserve = loadU4Field(d, ptr);\r\n    ptr += SizeOfStackReserve._size;\r\n\r\n    const SizeOfStackCommit = loadU4Field(d, ptr);\r\n    ptr += SizeOfStackCommit._size;\r\n\r\n    const SizeOfHeapReserve = loadU4Field(d, ptr);\r\n    ptr += SizeOfHeapReserve._size;\r\n\r\n    const SizeOfHeapCommit = loadU4Field(d, ptr);\r\n    ptr += SizeOfHeapCommit._size;\r\n\r\n    const LoaderFlags = loadU4Field(d, ptr);\r\n    ptr += LoaderFlags._size;\r\n\r\n    const NumberOfRvaAndSizes = loadU4Field(d, ptr);\r\n    ptr += NumberOfRvaAndSizes._size;\r\n\r\n    return {\r\n        _offset: p, _size: ptr - p,\r\n        Magic,\r\n        MajorLinkerVersion,\r\n        MinorLinkerVersion,\r\n        SizeOfCode,\r\n        SizeOfInitializedData,\r\n        SizeOfUninitializedData,\r\n        AddressOfEntryPoint,\r\n        BaseOfCode,\r\n        BaseOfData,\r\n        ImageBase,\r\n        SectionAlignment,\r\n        FileAlignment,\r\n        MajorOperatingSystemVersion,\r\n        MinorOperatingSystemVersion,\r\n        MajorImageVersion,\r\n        MinorImageVersion,\r\n        MajorSubsystemVersion,\r\n        MinorSubsystemVersion,\r\n        Win32VersionValue,\r\n        SizeOfImage,\r\n        SizeOfHeaders,\r\n        CheckSum,\r\n        Subsystem,\r\n        DllCharacteristics,\r\n        SizeOfStackReserve,\r\n        SizeOfStackCommit,\r\n        SizeOfHeapReserve,\r\n        SizeOfHeapCommit,\r\n        LoaderFlags,\r\n        NumberOfRvaAndSizes,\r\n    };\r\n}\r\n\r\nexport function loadImageOptionalHeader64(d: FileDataProvider, p: number): S.ImageOptionalHeader64 {\r\n    let ptr = p;\r\n\r\n    const Magic = loadU2Field(d, ptr);\r\n    ptr += Magic._size;\r\n\r\n    const MajorLinkerVersion = loadU1Field(d, ptr);\r\n    ptr += MajorLinkerVersion._size;\r\n\r\n    const MinorLinkerVersion = loadU1Field(d, ptr);\r\n    ptr += MinorLinkerVersion._size;\r\n\r\n    const SizeOfCode = loadU4Field(d, ptr);\r\n    ptr += SizeOfCode._size;\r\n\r\n    const SizeOfInitializedData = loadU4Field(d, ptr);\r\n    ptr += SizeOfInitializedData._size;\r\n\r\n    const SizeOfUninitializedData = loadU4Field(d, ptr);\r\n    ptr += SizeOfUninitializedData._size;\r\n\r\n    const AddressOfEntryPoint = loadU4Field(d, ptr);\r\n    ptr += AddressOfEntryPoint._size;\r\n\r\n    const BaseOfCode = loadU4Field(d, ptr);\r\n    ptr += BaseOfCode._size;\r\n\r\n    const ImageBase = loadU8Field(d, ptr);\r\n    ptr += ImageBase._size;\r\n\r\n    const SectionAlignment = loadU4Field(d, ptr);\r\n    ptr += SectionAlignment._size;\r\n\r\n    const FileAlignment = loadU4Field(d, ptr);\r\n    ptr += FileAlignment._size;\r\n\r\n    const MajorOperatingSystemVersion = loadU2Field(d, ptr);\r\n    ptr += MajorOperatingSystemVersion._size;\r\n\r\n    const MinorOperatingSystemVersion = loadU2Field(d, ptr);\r\n    ptr += MinorOperatingSystemVersion._size;\r\n\r\n    const MajorImageVersion = loadU2Field(d, ptr);\r\n    ptr += MajorImageVersion._size;\r\n\r\n    const MinorImageVersion = loadU2Field(d, ptr);\r\n    ptr += MinorImageVersion._size;\r\n\r\n    const MajorSubsystemVersion = loadU2Field(d, ptr);\r\n    ptr += MajorSubsystemVersion._size;\r\n\r\n    const MinorSubsystemVersion = loadU2Field(d, ptr);\r\n    ptr += MinorSubsystemVersion._size;\r\n\r\n    const Win32VersionValue = loadU4Field(d, ptr);\r\n    ptr += Win32VersionValue._size;\r\n\r\n    const SizeOfImage = loadU4Field(d, ptr);\r\n    ptr += SizeOfImage._size;\r\n\r\n    const SizeOfHeaders = loadU4Field(d, ptr);\r\n    ptr += SizeOfHeaders._size;\r\n\r\n    const CheckSum = loadU4Field(d, ptr);\r\n    ptr += CheckSum._size;\r\n\r\n    const Subsystem = loadU2EnumField<F.ImageSubsystem>(d, ptr);\r\n    ptr += Subsystem._size;\r\n\r\n    const DllCharacteristics = loadU2EnumField<F.ImageDllCharacteristics>(d, ptr);\r\n    ptr += DllCharacteristics._size;\r\n\r\n    const SizeOfStackReserve = loadU8Field(d, ptr);\r\n    ptr += SizeOfStackReserve._size;\r\n\r\n    const SizeOfStackCommit = loadU8Field(d, ptr);\r\n    ptr += SizeOfStackCommit._size;\r\n\r\n    const SizeOfHeapReserve = loadU8Field(d, ptr);\r\n    ptr += SizeOfHeapReserve._size;\r\n\r\n    const SizeOfHeapCommit = loadU8Field(d, ptr);\r\n    ptr += SizeOfHeapCommit._size;\r\n\r\n    const LoaderFlags = loadU4Field(d, ptr);\r\n    ptr += LoaderFlags._size;\r\n\r\n    const NumberOfRvaAndSizes = loadU4Field(d, ptr);\r\n    ptr += NumberOfRvaAndSizes._size;\r\n\r\n    return {\r\n        _offset: p, _size: ptr - p,\r\n        Magic,\r\n        MajorLinkerVersion,\r\n        MinorLinkerVersion,\r\n        SizeOfCode,\r\n        SizeOfInitializedData,\r\n        SizeOfUninitializedData,\r\n        AddressOfEntryPoint,\r\n        BaseOfCode,\r\n        ImageBase,\r\n        SectionAlignment,\r\n        FileAlignment,\r\n        MajorOperatingSystemVersion,\r\n        MinorOperatingSystemVersion,\r\n        MajorImageVersion,\r\n        MinorImageVersion,\r\n        MajorSubsystemVersion,\r\n        MinorSubsystemVersion,\r\n        Win32VersionValue,\r\n        SizeOfImage,\r\n        SizeOfHeaders,\r\n        CheckSum,\r\n        Subsystem,\r\n        DllCharacteristics,\r\n        SizeOfStackReserve,\r\n        SizeOfStackCommit,\r\n        SizeOfHeapReserve,\r\n        SizeOfHeapCommit,\r\n        LoaderFlags,\r\n        NumberOfRvaAndSizes,\r\n    };\r\n}\r\n\r\nexport function loadImageDataDirectory(d: FileDataProvider, p: number): S.ImageDataDirectory {\r\n    let ptr = p;\r\n\r\n    const VirtualAddress = loadU4Field(d, ptr);\r\n    ptr += VirtualAddress._size;\r\n\r\n    const Size = loadU4Field(d, ptr);\r\n    ptr += Size._size;\r\n\r\n    return {\r\n        _offset: p, _size: ptr - p,\r\n        VirtualAddress,\r\n        Size,\r\n    };\r\n}\r\n\r\nexport function loadImageSectionHeader(d: FileDataProvider, p: number): S.ImageSectionHeader {\r\n    let ptr = p;\r\n\r\n    const Name = loadFixedSizeAsciiStringField(d, ptr, 8);\r\n    ptr += Name._size;\r\n\r\n    const VirtualSize = loadU4Field(d, ptr);\r\n    ptr += VirtualSize._size;\r\n\r\n    const VirtualAddress = loadU4Field(d, ptr);\r\n    ptr += VirtualAddress._size;\r\n\r\n    const SizeOfRawData = loadU4Field(d, ptr);\r\n    ptr += SizeOfRawData._size;\r\n\r\n    const PointerToRawData = loadU4Field(d, ptr);\r\n    ptr += PointerToRawData._size;\r\n\r\n    const PointerToRelocations = loadU4Field(d, ptr);\r\n    ptr += PointerToRelocations._size;\r\n\r\n    const PointerToLinenumbers = loadU4Field(d, ptr);\r\n    ptr += PointerToLinenumbers._size;\r\n\r\n    const NumberOfRelocations = loadU2Field(d, ptr);\r\n    ptr += NumberOfRelocations._size;\r\n\r\n    const NumberOfLinenumbers = loadU2Field(d, ptr);\r\n    ptr += NumberOfLinenumbers._size;\r\n\r\n    const Characteristics = loadU4EnumField<F.ImageSection>(d, ptr);\r\n    ptr += Characteristics._size;\r\n\r\n    return {\r\n        _offset: p, _size: ptr - p,\r\n        Name,\r\n        VirtualSize,\r\n        VirtualAddress,\r\n        SizeOfRawData,\r\n        PointerToRawData,\r\n        PointerToRelocations,\r\n        PointerToLinenumbers,\r\n        NumberOfRelocations,\r\n        NumberOfLinenumbers,\r\n        Characteristics,\r\n    };\r\n}"],"sourceRoot":""}